# üï∏Ô∏è Open Ahrefs Scrapy

–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∫—Ä–∞—É–ª–µ—Ä –Ω–∞ –±–∞–∑–µ **Scrapy** –∏ **Scrapy-Redis**, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–∞–π—Ç–æ–≤, –∞–Ω–∞–ª–∏–∑–∞ —Ü–µ–ø–æ—á–µ–∫ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤ –∏ —Å–±–æ—Ä–∞ –º–µ—Ç–∞-–¥–∞–Ω–Ω—ã—Ö.

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–ø—É—Å–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ (–ø–æ–¥–æ–≤) —á–µ—Ä–µ–∑ –æ–±—â—É—é –æ—á–µ—Ä–µ–¥—å –≤ Redis.
* **–£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ DNS, —Ç–∞–π–º–∞—É—Ç–æ–≤ –∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö —Å—Ö–µ–º (mailto/tel).
* **–ê–Ω–∞–ª–∏–∑ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (`redirect_urls`) –¥–∞–∂–µ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Å—ã–ª–∫–∏.
* **–ì–∏–±–∫–∏–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (HTML/JSON) –∏ –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–∞–¥–µ–Ω–∏–π –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ç–µ–≥–æ–≤.
* **Monitoring Ready**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–∏—Å–ª–æ–≤—ã—Ö –º–µ—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏ (Timestamp) –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É "Producer-Consumer":

1. **Redis** —Ö—Ä–∞–Ω–∏—Ç –æ—á–µ—Ä–µ–¥—å `crawler:start_urls` –∑–∞–¥–∞—á.
2. **Scrapy-–ø–∞—É–∫–∏** –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –∑–∞–¥–∞—á–∏, –ø—Ä–æ–≤–µ—Ä—è—è –Ω–∞ –¥—É–±–ª–∏.
3. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –≤ Redis-—Å–ø–∏—Å–æ–∫ `crawler:items` –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±—ç–∫–µ–Ω–¥–æ–º.

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

* **Core:** Python 3.12, Scrapy
* **Distributed:** Scrapy-Redis
* **Networking:** Twisted
* **Logging:** Scrapy Logger (–Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –≤—ã–≤–æ–¥ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫)

## üì¶ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### 1. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

```bash
docker-compose up --build
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏

–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É, –¥–æ–±–∞–≤—å—Ç–µ URL –≤ –æ—á–µ—Ä–µ–¥—å Redis:

```bash
redis-cli rpush crawler:start_urls "https://example.com/"
```

## üìä –§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ö–∞–∂–¥—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –æ—á–µ—Ä–µ–¥–∏ `crawler:items` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π JSON —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–¥–∞:

```json
{
  "url": "https://example.com/contacts/",
  "status": 200,
  "title": "Contacts | My Site",
  "redirect_urls": ["http://example.com/contacts/"],
  "referer": "https://example.com/",
  "task": "20260118060512987654:https://example.com/"
}
```

*–ï—Å–ª–∏ –¥–æ–º–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω, `status` –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω `999`, –∞ –≤ `title` –±—É–¥–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏.*

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `pytest`:

```bash
pytest tests/
```

*–¢–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞—é—Ç Redis-–±–∞–∑—É –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∑–∞–ø—É—Å–∫–æ–º.*
